"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[25285,27810,33085,34405,98088],{22148:(M,N,n)=>{var j,S;j=[n(22410),n(60984),n(8454),n(57642),n(47536),n(96352),n(43349),n(95692),n(52473),n(68636),n(91749),n(49897),n(29930),n(33530),n(57576)],S=function(E,v,d,h,f,e,p,k,a,c,r,u,y,b,w){const x={};let g="0",T="";$(window).on("action:ajaxify.start",function(i,l){h.removeListeners(),String(l.url).startsWith("topic/")||(e.disable(),a.get("navbar/title").find("span").text("").hide(),y.remove("bookmark"))}),x.init=async function(){console.log("topic.init is running");const i=g==="0"||String(g)!==String(ajaxify.data.tid);g=String(ajaxify.data.tid),T=ajaxify.currentPage,r.fire("action:topic.loading"),app.enterRoom("topic_"+g),i&&(f.signaturesShown={}),await f.onTopicPageLoad(a.get("post")),e.init('[component="topic"]>[component="post"]',ajaxify.data.postcount,x.toTop,x.toBottom,x.navigatorCallback),d.init(g),v.init(g,$(".topic")),h.init(),p.handleSort("topicPostSort","topic/"+ajaxify.data.slug),config.usePagination||E.init($('[component="topic"]'),f.loadMorePosts),t(),m(),P(),B(),F(),Q(),W(g),U(),$(window).on("scroll",utils.debounce(z,250)),H(),r.fire("action:topic.loaded",ajaxify.data),R()};function H(){Promise.resolve().then(function(){var i=[n(6411)];(l=>{config.topicSearchEnabled&&n.e(69749).then(function(){var o=[n(69749)];(function(s){l.bind(["command+f","ctrl+f"],function(C){C.preventDefault();let D=$('[component="navbar"] [component="search/form"]');D.length||(D=$('[component="sidebar/right"] [component="search/form"]')),D.find('[component="search/fields"] input[name="query"]').val("in:topic-"+ajaxify.data.tid+" "),s.showAndFocusInput(D)}),r.onPage("action:ajaxify.cleanup",()=>{l.unbind(["command+f","ctrl+f"])})}).apply(null,o)}).catch(n.oe),l.bind("j",o=>{if(o.target.classList.contains("mousetrap"))return;const s=e.getIndex(),C=e.getCount();s!==C&&e.scrollToIndex(s,!0,0)}),l.bind("k",o=>{if(o.target.classList.contains("mousetrap"))return;const s=e.getIndex();s!==1&&e.scrollToIndex(s-2,!0,0)})}).apply(null,i)}).catch(n.oe)}x.toTop=function(){e.scrollTop(0)},x.toBottom=function(){socket.emit("topics.postcount",ajaxify.data.tid,function(i,l){if(i)return y.error(i);e.scrollBottom(l-1)})};function W(i){if(window.location.hash){const s=$(utils.escapeHTML(window.location.hash));if(s.length){const C=s.parents("[data-pid]");return e.scrollToElement(C,!0,0)}}const l=ajaxify.data.bookmark||c.getItem("topic:"+i+":bookmark"),o=ajaxify.data.postIndex;if(I(o),e.shouldScrollToPost(o))return e.scrollToPostIndex(o-1,!0,0);l&&(!config.usePagination||config.usePagination&&ajaxify.data.pagination.currentPage===1)&&ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&y.alert({alert_id:"bookmark",message:"[[topic:bookmark-instructions]]",timeout:15e3,type:"info",clickfn:function(){e.scrollToIndex(Math.max(0,parseInt(l,10)-1),!0)},closefn:function(){c.removeItem("topic:"+i+":bookmark")}})}function U(){const i=document.querySelector('[component="topic/thumb/list"]');i&&i.addEventListener("click",async l=>{const o=l.target.closest("a");if(o){const s=Array.from(o.parentNode.children).indexOf(o);l.stopPropagation(),l.preventDefault();const C=ajaxify.data.thumbs.map(A=>({...A}));C.forEach((A,O)=>{A.selected=O===s});const D=await app.parseAndTranslate("modals/topic-thumbs-view",{src:o.href,thumbs:C});b.dialog({size:"lg",onEscape:!0,backdrop:!0,message:D}).on("click",'[component="topic/thumb/select"]',function(){$('[component="topic/thumb/select"]').removeClass("border-primary"),$(this).addClass("border-primary"),$('[component="topic/thumb/current"]').attr("src",$(this).attr("src"))})}})}function t(){a.get("topic").on("click","blockquote .toggle",function(){const i=$(this).parent("blockquote"),l=$(this);i.toggleClass("uncollapsed");const o=!i.hasClass("uncollapsed");l.toggleClass("fa-angle-down",o).toggleClass("fa-angle-up",!o)})}function m(){new w('[component="copy/code/btn"]',{text:function(l){const o=$(l);o.find("i").removeClass("fa-copy").addClass("fa-check"),setTimeout(()=>o.find("i").removeClass("fa-check").addClass("fa-copy"),2e3);const s=o.parent().find("code");return s.attr("data-lines")&&s.find(".hljs-ln-code[data-line-number]").length?s.find(".hljs-ln-code[data-line-number]").map((C,D)=>D.textContent).get().join(`
`):s.text()}});function i(){function l(A){return A.scrollHeight>A.clientHeight}function o(A){if(A.length){if(!A[0].scrollHeight)return setTimeout(o,100,A);l(A.get(0))&&A.parent().parent().find('[component="copy/code/btn"]').css({margin:"0.5rem 1.5rem 0 0"})}}let s=$('[component="topic"] [component="post/content"] code:not([data-button-added])');s=s.filter((A,O)=>$(O).text().includes(`
`));const C=$('<div class="hover-parent position-relative"></div>'),D=$('<button component="copy/code/btn" class="hover-visible position-absolute top-0 btn btn-sm btn-outline-secondary" style="right: 0px; margin: 0.5rem 0.5rem 0 0;"><i class="fa fa-fw fa-copy"></i></button>'),L=s.parent();L.wrap(C).parent().append(D),L.parent().find('[component="copy/code/btn"]').translateAttr("title","[[topic:copy-code]]"),L.each((A,O)=>{o($(O).find("code"))}),s.attr("data-button-added",1)}r.registerPage("action:posts.loaded",i),r.registerPage("action:topic.loaded",i),r.registerPage("action:posts.edited",i)}function P(){function i(l,o){const s=$('[component="topic"]>[component="post"][data-pid="'+o+'"]');if(s.length)return l.preventDefault(),e.scrollToIndex(s.attr("data-index"),!0),!1}a.get("topic").on("click",'[component="post/parent"]',function(l){const o=$(this),s=o.find('[component="post/parent/content"]');if(s.length){const C=o.attr("data-collapsed")==="true";if(o.attr("data-collapsed",C?"false":"true"),s.toggleClass("line-clamp-1"),o.find(".timeago").toggleClass("hidden"),o.toggleClass("flex-column").toggleClass("flex-row"),C)return!1}else return i(l,o.attr("data-topid"))}),a.get("topic").on("click",'[component="post/parent"] .timeago',function(l){return i(l,$(this).parents("[data-parent-pid]").attr("data-parent-pid"))})}function B(){$('[component="topic"]').on("click",'[component="post/reply-count"]',function(){const i=$(this);n.e(18631).then(function(){var l=[n(18631)];(function(o){o.init(i)}).apply(null,l)}).catch(n.oe)})}function F(){if(!ajaxify.data.showPostPreviewsOnHover||utils.isMobile())return;let i=0,l=!1,o=null;const s={};function C(){clearTimeout(i),i=0,$("#post-tooltip").remove(),l=!0}function D(L){$(L.target).closest("#post-tooltip").length||C()}$(window).one("action:ajaxify.start",C),$('[component="topic"]').on("mouseenter",'a[component="post/parent"], [component="post/parent/content"] a,[component="post/content"] a, [component="topic/event"] a',async function(){o=$(this),o.removeAttr("over-tooltip"),o.one("mouseleave",function(){clearTimeout(i),i=0,setTimeout(()=>{!o.attr("over-tooltip")&&!i&&C()},100)}),clearTimeout(i),l=!1,i=setTimeout(async()=>{async function L(K){const J=s[K]||await u.get(`/posts/${encodeURIComponent(K)}/summary`);if($("#post-tooltip").remove(),J&&ajaxify.data.template.topic){s[K]=J;const Y=await app.parseAndTranslate("partials/topic/post-preview",{post:J});if(l)return;Y.hide().find(".timeago").timeago(),Y.appendTo($("body")).fadeIn(300);const q=o.parents('[component="topic"]').find('[component="post/content"]').first(),tt=q.offset(),et=q.width(),_=o.offset(),{top:ot}=o.get(0).getBoundingClientRect(),nt=ot>window.innerHeight/2;Y.on("mouseenter",function(){o.attr("over-tooltip",1)}),Y.one("mouseleave",C),$(window).off("click",D).one("click",D),Y.css({top:nt?_.top-Y.outerHeight():_.top+30,left:tt.left,width:et})}}const A=o.attr("href"),O=utils.urlToLocation(A),V=O.pathname,X=A&&A!=="#"&&window.location.hostname===O.hostname;$("#post-tooltip").remove();const G=X&&V&&V.match(/\/post\/([\d]+|(?:[\w_.~!$&'()*+,;=:@-]|%[\dA-F]{2})+)/),Z=X&&V&&V.match(/\/topic\/([\da-z-]+)/);if(G){const K=G[1];if(encodeURIComponent(o.parents('[component="post"]').attr("data-pid"))===encodeURIComponent(K))return;L(K)}else if(Z){const K=Z[1],J=await u.get("/topics/"+K,{});L(J.mainPid)}},300)})}function Q(){(config.enableQuickReply||config.theme&&config.theme.enableQuickReply)&&k.init()}function z(){const i=a.get("navbar/title").find("span");$(window).scrollTop()>50&&i.hasClass("hidden")?i.html(ajaxify.data.title).removeClass("hidden"):$(window).scrollTop()<=50&&!i.hasClass("hidden")&&i.html("").addClass("hidden"),$(window).scrollTop()>300&&y.remove("bookmark")}x.navigatorCallback=function(i,l){if(!ajaxify.data.template.topic||e.scrollActive)return;const o="topic/"+ajaxify.data.slug+(i>1?"/"+i:"");if(o!==T&&(T=o,i>=l&&app.user.uid&&u.put(`/topics/${ajaxify.data.tid}/read`),I(i),ajaxify.data.updateUrlWithPostIndex&&history.replaceState)){let s=window.location.search||"";config.usePagination||(s=s&&!/^\?page=\d+$/.test(s)?s:""),history.replaceState({url:o+s},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+o+s)}};function I(i){const l="topic:"+ajaxify.data.tid+":bookmark",o=ajaxify.data.bookmark||c.getItem(l);config.topicPostSort==="newest_to_oldest"&&(i=Math.max(1,ajaxify.data.postcount-i+2)),ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(!o||parseInt(i,10)>parseInt(o,10)||ajaxify.data.postcount<parseInt(o,10))&&(app.user.uid?(ajaxify.data.bookmark=Math.min(i,ajaxify.data.postcount),socket.emit("topics.bookmark",{tid:ajaxify.data.tid,index:ajaxify.data.bookmark},function(s){if(s)return ajaxify.data.bookmark=o,y.error(s)})):c.setItem(l,i)),(!o||parseInt(i,10)>=parseInt(o,10))&&y.remove("bookmark")}function R(){console.log("check resolved/unresolved status"),$('[component="post"]').each(function(i){const l=$(this);console.log("Found post:",i,l);const o=!1,s=$(`
				<div class="post-toggle" style="cursor: pointer; padding: 5px; margin: 5px; display: flex; align-items: center; gap: 8px;">
					<div class="checkbox" style="width: 16px; height: 16px; border: 2px solid #ccc; display: inline-block; text-align: center; line-height: 12px; font-size: 12px;">
						${o?"\u2713":""}
					</div>
					<span class="status-text" style="color: ${o?"green":"red"}">
						${o?"resolved":"unresolved"}
					</span>
				</div>
			`);s.on("click",function(){const C=$(this).find(".checkbox"),D=$(this).find(".status-text"),A=!(C.text().trim()==="\u2713");C.text(A?"\u2713":""),D.text(A?"resolved":"unresolved"),D.css("color",A?"green":"red"),console.log("Status toggled to:",A?"resolved":"unresolved")}),l.prepend(s)})}return x}.apply(N,j),S!==void 0&&(M.exports=S)},34405:(M,N,n)=>{var j,S;j=[n(49897),n(29930),n(36e3),n(9787),n(35786)],S=function(E,v,{Textcomplete:d},{TextareaEditor:h},{ContenteditableEditor:f}){const e={},p={delay:200,appendTo:null};e.init=a=>{const c={...p,...a},{input:r,onSelect:u}=c;app.loadJQueryUI(function(){r.autocomplete({...c,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(y,b){k(r,u,y,b)}})})},e.user=function(a,c,r){typeof c=="function"&&(r=c,c={}),c=c||{},e.init({input:a,onSelect:r,source:(u,y)=>{c.query=u.term,E.get("/api/users",c,function(b,w){if(b)return v.error(b);if(w&&w.users){const x=w.users.map(function(g){const T=$("<div></div>").html(g.username).text();return g&&{label:T,value:T,user:{uid:g.uid,name:g.username,slug:g.userslug,username:g.username,userslug:g.userslug,displayname:g.displayname,picture:g.picture,banned:g.banned,"icon:text":g["icon:text"],"icon:bgColor":g["icon:bgColor"]}}});y(x)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},e.group=function(a,c){e.init({input:a,onSelect:c,source:(r,u)=>{socket.emit("groups.search",{query:r.term},function(y,b){if(y)return v.error(y);if(b&&b.length){const w=b.map(function(x){return x&&{label:x.name,value:x.name,group:x}});u(w)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},e.tag=function(a,c){e.init({input:a,onSelect:c,delay:100,source:(r,u)=>{socket.emit("topics.autocompleteTags",{query:r.term,cid:ajaxify.data.cid||0},function(y,b){if(y)return v.error(y);b&&u(b),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function k(a,c,r,u){c=c||function(){};const y=jQuery.Event("keypress");y.which=13,y.keyCode=13,setTimeout(function(){a.trigger(y)},100),c(r,u)}return e.setup=function({element:a,strategies:c,options:r}){const u=a.get(0);if(u){var y;if(u.nodeName==="TEXTAREA"||u.nodeName==="INPUT"?y=new h(u):u.nodeName==="DIV"&&u.getAttribute("contenteditable")==="true"&&(y=new f(u)),!y)throw new Error("unknown target element type");u.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var b=new d(y,c,{dropdown:r});return b.on("rendered",function(){b.dropdown.items.length&&b.dropdown.items[0].activate()}),b}},e}.apply(N,j),S!==void 0&&(M.exports=S)},43103:(M,N,n)=>{var j,S;j=[n(29930)],S=function(E){const v={};return v.init=function(d){const h=d.uploadFormEl;if(h.length&&(h.attr("action",config.relative_path+d.route),d.dragDropAreaEl&&v.handleDragDrop({container:d.dragDropAreaEl,callback:function(f){v.ajaxSubmit({uploadForm:h,upload:f,callback:d.callback})}}),d.pasteEl&&v.handlePaste({container:d.pasteEl,callback:function(f){v.ajaxSubmit({uploadForm:h,upload:f,callback:d.callback})}}),d.uploadBtnEl)){const f=h.find('input[name="files[]"]');d.uploadBtnEl.on("click",function(){return f.trigger("click"),!1}),f.on("change",function(e){const p=(e.target||{}).files||($(this).val()?[{name:$(this).val(),type:utils.fileMimeType($(this).val())}]:null);p&&v.ajaxSubmit({uploadForm:h,upload:{files:p,fileNames:Array.from(p).map(k=>k.name)},callback:d.callback})})}},v.handleDragDrop=function(d){let h=!1;const f=d.container,e=d.container.find(".imagedrop");f.on("dragenter",function(){h||(e.css("top","0px"),e.css("height",f.height()+"px"),e.css("line-height",f.height()+"px"),e.show(),e.on("dragleave",function(){e.hide(),e.off("dragleave")}))}),e.on("drop",function(a){a.preventDefault();const c=a.originalEvent.dataTransfer.files;if(c.length){let u;if(window.FormData){u=new FormData;for(var r=0;r<c.length;++r)u.append("files[]",c[r],c[r].name)}d.callback({files:c,formData:u})}return e.hide(),!1});function p(k){return k.preventDefault(),!1}$(document).off("dragstart").on("dragstart",function(){h=!0}).off("dragend").on("dragend, mouseup",function(){h=!1}),e.on("dragover",p),e.on("dragenter",p)},v.handlePaste=function(d){d.container.on("paste",function(f){const e=(f.clipboardData||f.originalEvent.clipboardData||{}).items,p=[],k=[];let a=null;window.FormData&&(a=new FormData),[].forEach.call(e,function(c){const r=c.getAsFile();if(r){const u=utils.generateUUID()+"-"+r.name;a&&a.append("files[]",r,u),p.push(r),k.push(u)}}),p.length&&d.callback({files:p,fileNames:k,formData:a})})},v.ajaxSubmit=function(d){const h=[...d.upload.files];for(let e=0;e<h.length;++e){const p=h[e].type.match(/image./);if(p&&!app.user.privileges["upload:post:image"]||!p&&!app.user.privileges["upload:post:file"])return E.error("[[error:no-privileges]]");if(!app.user.isAdmin&&h[e].size>parseInt(config.maximumFileSize,10)*1024)return d.uploadForm[0].reset(),E.error("[[error:file-too-big, "+config.maximumFileSize+"]]")}const f=Date.now();d.uploadForm.off("submit").on("submit",function(){return $(this).ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},resetForm:!0,clearForm:!0,formData:d.upload.formData,error:function(e){let p=e.responseJSON&&(e.responseJSON.error||e.responseJSON.status&&e.responseJSON.status.message)||"[[error:parse-error]]";e&&e.status===413&&(p=e.statusText||"Request Entity Too Large"),E.error(p),E.remove(f)},uploadProgress:function(e,p,k,a){E.alert({alert_id:f,message:"[[modules:composer.uploading, "+a+"%]]"})},success:function(e){const p=e.response.images;if(p&&p.length)for(var k=0;k<p.length;++k)p[k].filename=h[k].name,p[k].isImage=/image./.test(h[k].type);d.callback(p)},complete:function(){d.uploadForm[0].reset(),setTimeout(E.remove,100,f)}}),!1}),d.uploadForm.submit()},v}.apply(N,j),S!==void 0&&(M.exports=S)},43349:(M,N,n)=>{var j,S;j=[n(52473)],S=function(E){const v={};return v.handleSort=function(d,h){const f=E.get("thread/sort");f.find("i").removeClass("fa-check");const e=utils.params().sort||config[d];f.find('a[data-sort="'+e+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a[data-sort]').on("click",'[component="thread/sort"] a[data-sort]',function(){const k=$(this).attr("data-sort"),a=utils.params();a.sort=k;const c=$.param(a);ajaxify.go(h+(c?"?"+c:""))})},v}.apply(N,j),S!==void 0&&(M.exports=S)},57642:(M,N,n)=>{var j,S;j=[n(8454),n(60984),n(47536),n(2269),n(52473),n(17459),n(91749),n(30076)],S=function(E,v,d,h,f,e,p,k){const a={},c={"event:user_status_change":r,"event:voted":u,"event:bookmarked":y,"event:topic_deleted":v.setDeleteState,"event:topic_restored":v.setDeleteState,"event:topic_purged":b,"event:topic_locked":v.setLockedState,"event:topic_unlocked":v.setLockedState,"event:topic_pinned":v.setPinnedState,"event:topic_unpinned":v.setPinnedState,"event:topic_moved":w,"event:post_edited":x,"event:post_purged":g,"event:post_deleted":T,"event:post_restored":T,"posts.bookmark":H,"posts.unbookmark":H,"posts.upvote":W,"posts.downvote":W,"posts.unvote":W,"event:new_notification":U,"event:new_post":d.onNewPost};a.init=function(){a.removeListeners();for(const[t,m]of Object.entries(c))socket.on(t,m)},a.removeListeners=function(){for(const[t,m]of Object.entries(c))socket.removeListener(t,m)};function r(t){app.updateUserStatus($('[data-uid="'+t.uid+'"] [component="user/status"]'),t.status)}function u(t){const m=$('[data-pid="'+t.post.pid+'"] [component="post/vote-count"]').filter(function(B,F){return $(F).closest("[data-pid]").attr("data-pid")===String(t.post.pid)}),P=$('.reputation[data-uid="'+t.post.uid+'"]');m.html(t.post.votes).attr("data-votes",t.post.votes),P.html(t.user.reputation).attr("data-reputation",t.user.reputation)}function y(t){$('[data-pid="'+t.post.pid+'"] .bookmarkCount').filter(function(m,P){return $(P).closest("[data-pid]").attr("data-pid")===String(t.post.pid)}).html(t.post.bookmarks).attr("data-bookmarks",t.post.bookmarks)}function b(t){ajaxify.data.category&&ajaxify.data.category.slug&&String(t.tid)===String(ajaxify.data.tid)&&ajaxify.go("category/"+ajaxify.data.category.slug,null,!0)}function w(t){t&&t.slug&&String(t.tid)===String(ajaxify.data.tid)&&ajaxify.go("topic/"+t.slug,null,!0)}function x(t){if(!t||!t.post||String(t.post.tid)!==String(ajaxify.data.tid))return;const m=f.get("post/content",t.post.pid).filter(function(I,R){return String($(R).closest("[data-pid]").attr("data-pid"))===String(t.post.pid)}),P=$(`[data-pid="${t.post.pid}"]`),B=P.find('[component="post/editor"]').filter(function(I,R){return String($(R).closest("[data-pid]").attr("data-pid"))===String(t.post.pid)}),F=f.get("topic/title"),Q=f.get("navbar/title").find("span"),z=f.get("breadcrumb/current");if(t.topic.rescheduled)return ajaxify.go("topic/"+t.topic.slug,null,!0);if(F.length&&t.topic.title&&t.topic.renamed){ajaxify.data.title=t.topic.title;const I="topic/"+t.topic.slug+(window.location.search?window.location.search:"");history.replaceState({url:I},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+I),F.fadeOut(250,function(){F.html(t.topic.title).fadeIn(250)}),z.fadeOut(250,function(){z.html(t.topic.title).fadeIn(250)}),Q.fadeOut(250,function(){Q.html(t.topic.title).fadeIn(250)})}if(t.post.changed){m.fadeOut(250,function(){if(m.html(e.unescape(t.post.content)),m.find("img:not(.not-responsive)").addClass("img-fluid"),h.wrapImagesInLinks(m.parent()),d.addBlockquoteEllipses(m.parent()),m.fadeIn(250),t.post.edited){const R={editor:t.editor,editedISO:utils.toISOString(t.post.edited)};app.parseAndTranslate("partials/topic/post-editor",R,function(i){B.replaceWith(i),P.find('[component="post/edit-indicator"]').removeClass("hidden").translateAttr("title",`[[global:edited-timestamp, ${k.isoTimeToLocaleString(R.editedISO,config.userLang)}]]`),P.find('[component="post/editor"] .timeago').timeago(),p.fire("action:posts.edited",t)})}});const I=$(`[component="post/parent"][data-parent-pid="${t.post.pid}"]`);I.length&&(I.find('[component="post/parent/content"]').html(e.unescape(t.post.content)),I.find("img:not(.not-responsive)").addClass("img-fluid"),I.find('[component="post/parent/content]" img:not(.emoji)').each(function(){h.wrapImageInLink($(this))}))}else p.fire("action:posts.edited",t);t.topic.tags&&t.topic.tagsupdated&&Promise.all([n.e(20056),n.e(63)]).then(function(){var I=[n(63)];(function(R){R.updateTopicTags([t.topic])}).apply(null,I)}).catch(n.oe),E.removeMenu(f.get("post","pid",t.post.pid))}function g(t){!t||String(t.tid)!==String(ajaxify.data.tid)||(f.get("post","pid",t.pid).fadeOut(500,function(){$(this).remove(),d.showBottomPostBar()}),ajaxify.data.postcount-=1,E.updatePostCount(ajaxify.data.postcount),n.e(18631).then(function(){var m=[n(18631)];(function(P){P.onPostPurged(t)}).apply(null,m)}).catch(n.oe),$(`[component="post/parent"][data-parent-pid="${t.pid}"]`).remove())}function T(t){const m=f.get("post","pid",t.pid),{isAdminOrMod:P}=ajaxify.data.privileges,B=String(t.uid)===String(app.user.uid),F=!!t.deleted;m.length&&(m.toggleClass("deleted"),E.toggle(t.pid,F),!P&&!B&&(m.find('[component="post/tools"]').toggleClass("hidden",F),F?m.find('[component="post/content"]').translateHtml("[[topic:post-is-deleted]]"):m.find('[component="post/content"]').html(e.unescape(t.content))));const Q=$(`[component="post/parent"][data-parent-pid="${t.pid}"]`);Q.length&&Q.each((z,I)=>{const R=$(I);F?R.find('[component="post/parent/content"]').translateHtml("[[topic:post-is-deleted]]"):R.find('[component="post/parent/content"]').html(e.unescape(t.content))})}function H(t){const m=$('[data-pid="'+t.post.pid+'"] [component="post/bookmark"]').filter(function(P,B){return $(B).closest("[data-pid]").attr("data-pid")===String(t.post.pid)});m.length&&(m.attr("data-bookmarked",t.isBookmarked),m.find('[component="post/bookmark/on"]').toggleClass("hidden",!t.isBookmarked),m.find('[component="post/bookmark/off"]').toggleClass("hidden",t.isBookmarked))}function W(t){const m=$('[data-pid="'+t.post.pid+'"]');m.find('[component="post/upvote"]').filter(function(P,B){return $(B).closest("[data-pid]").attr("data-pid")===String(t.post.pid)}).toggleClass("upvoted",t.upvote),m.find('[component="post/downvote"]').filter(function(P,B){return $(B).closest("[data-pid]").attr("data-pid")===String(t.post.pid)}).toggleClass("downvoted",t.downvote)}function U(t){const m=ajaxify.data.tid;t&&t.tid&&String(t.tid)===String(m)&&socket.emit("topics.markTopicNotificationsRead",[m])}return a}.apply(N,j),S!==void 0&&(M.exports=S)},95692:(M,N,n)=>{var j,S;j=[n(52473),n(34405),n(49897),n(29930),n(43103),n(6411),n(68636),n(91749)],S=function(E,v,d,h,f,e,p,k){const a={_autocomplete:null};a.init=function(){const r=E.get("topic/quickreply/text"),u=`qr:draft:tid:${ajaxify.data.tid}`,y={element:r,strategies:[],options:{style:{"z-index":100}}};c(),$(window).one("action:ajaxify.start",()=>{c()}),$(window).trigger("composer:autocomplete:init",y),a._autocomplete=v.setup(y),e.bind("ctrl+return",x=>{x.target===r.get(0)&&E.get("topic/quickreply/button").get(0).click()}),f.init({uploadBtnEl:$('[component="topic/quickreply/upload/button"]'),dragDropAreaEl:$('[component="topic/quickreply/container"] .quickreply-message'),pasteEl:r,uploadFormEl:$('[component="topic/quickreply/upload"]'),inputEl:r,route:"/api/post/upload",callback:function(x){let g=r.val();x.forEach(T=>{g=g+(g?`
`:"")+(T.isImage?"!":"")+`[${T.filename}](${T.url})`}),r.val(g)}});let b=!0;E.get("topic/quickreply/button").on("click",function(x){if(x.preventDefault(),!b)return;const g=E.get("topic/quickreply/text").val(),T={tid:ajaxify.data.tid,handle:void 0,content:g},H=g.length;if(H<parseInt(config.minimumPostLength,10))return h.error("[[error:content-too-short, "+config.minimumPostLength+"]]");if(H>parseInt(config.maximumPostLength,10))return h.error("[[error:content-too-long, "+config.maximumPostLength+"]]");b=!1,d.post(`/topics/${ajaxify.data.tid}`,T,function(W,U){if(b=!0,W)return h.error(W);U&&U.queued&&h.alert({type:"success",title:"[[global:alert.success]]",message:U.message,timeout:1e4,clickfn:function(){ajaxify.go(`/post-queue/${U.id}`)}}),E.get("topic/quickreply/text").val(""),p.removeItem(u),a._autocomplete.hide(),k.fire("action:quickreply.success",{data:U})})});const w=p.getItem(u);w&&r.val(w),r.on("keyup",utils.debounce(function(){const x=r.val();x?p.setItem(u,x):p.removeItem(u)},1e3)),E.get("topic/quickreply/expand").on("click",x=>{x.preventDefault(),p.removeItem(u);const g=E.get("topic/quickreply/text");k.fire("action:composer.post.new",{tid:ajaxify.data.tid,title:ajaxify.data.titleRaw,body:g.val()}),g.val("")})};function c(){a._autocomplete&&(a._autocomplete.destroy(),a._autocomplete=null)}return a}.apply(N,j),S!==void 0&&(M.exports=S)}}]);
